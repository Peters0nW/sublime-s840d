// SYNTAX TEST "Packages/s840d/s840d.sublime-syntax"

////////////////////////////////////////////////////
// SYNCHRON ACTION tests
// Performance: 1.5ms
////////////////////////////////////////////////////

// simplest example
N1 DO G0 F=$MN_USER_DATA_HEX[12 + R1] X10 Y20
// ^ keyword.control.async.operation
//    ^ support.function.iso

// constant condition
N2 WHEN TRUE DO M5=10
// ^ keyword.control.async.condition
//      ^ constant.language.boolean
//           ^ keyword.control.async.operation
//              ^ support.function.iso
//                ^ keyword.operator.assignment
//                 ^ constant.language.numeric

// condition expression and operation statement
N3 WHENEVER ABS(R1)==10 DO M5=SQRT(-R2)*$PI
// ^ keyword.control.async.condition
//          ^ support.function
//              ^ support.variable.r
//                 ^ keyword.operator.relational
//                   ^ constant.language.numeric
//                      ^ keyword.control.async.operation
//                         ^ support.function.iso
//                           ^ keyword.operator.assignment
//                            ^ support.function

// modal asynchronous positioning call
N3 ID=1 EVERY $A_DBB[5]<>0 DO POS[Q1]=$A_DBB[5]
// ^ keyword.control.async.identifier
//   ^ keyword.operator.assignment
//    ^ constant.language.numeric
//      ^ keyword.control.async.condition
//            ^ support.variable.nck
//                     ^ keyword.operator.relational
//                       ^ constant.language.numeric
//                         ^ keyword.control.async.operation
//                            ^ support.variable.iso
//                                   ^ keyword.operator.assignment

// modal asynchronous function without condition
N3 IDS=1 DO POS[Q1]=($A_DBB[5]+10/$PI)
// ^ keyword.control.async.identifier
//    ^ keyword.operator.assignment
//     ^ constant.language.numeric
//       ^ keyword.control.async.operation
//          ^ support.variable.iso
//                 ^ keyword.operator.assignment

// no assignments in condition allowed
N4 IDS==1 WHENEVER ABS(R1)=10 DO M5=SQRT(2)*$PI
// ^ keyword.control.async.identifier
//    ^ invalid.illegal
//     ^ keyword.operator.assignment
//      ^ constant.language.numeric
//        ^ keyword.control.async.condition
//                 ^ support.function
//                        ^ invalid.illegal
//                            ^ keyword.control.async.operation
//                               ^ support.function.iso
//                                 ^ keyword.operator.assignment
//                                  ^ support.function

; *************************************
; modal asynchronous actions
IDS                     ; id keyword only
IDS=                    ; id missing
IDS=10                  ; no condition or action
IDS=DO DO M6=5+R2       ; id invalid
IDS= WHENEVER DO        ; id missing
IDS 10 = 10 R1.7 DO START  ; id invalid
; *************************************
